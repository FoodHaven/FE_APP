<% if user_signed_in? %>
  <% if current_user.favorites.include?(@market.id) %>
<%= button_to "Remove from Favorites", user_favorite_path(current_user.id, @market.id), method: :delete, remote: true %>
  <% else %>
<%= button_to "Add to Favorites", user_favorites_path(current_user.id, market_id: @market.id), method: :patch, remote: true %>
  <% end %>
<% else %>
  <%= link_to "Sign in to add to favorites", login_path %>
<% end %>